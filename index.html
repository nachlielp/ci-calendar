<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <link rel="icon" type="image/svg+xml" href="/ci-logo-192-circle.png" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>לוח אירועי קונטקט אימפרוביזציה | CI Calendar</title>

        <link rel="manifest" href="/site.webmanifest" />
        <meta name="robots" content="index, follow" />
        <link rel="canonical" href="https://ci-events.org/" />

        <meta
            name="title"
            content="לוח אירועי קונטקט אימפרוביזציה בישראל | CI Calendar"
        />
        <meta
            name="description"
            content="לוח אירועי קונטקט אימפרוביזציה בישראל - ג'אמים, שיעורים, סדנאות. Contact Improvisation events in Israel."
        />
        <meta
            name="keywords"
            content="קונטקט אימפרוביזציה,contact, contact improvisation,גאם,קונטקט, ג'אם, jam, שיעורי קונטקט, ריקוד, מחול, קונטקט בישראל, CI Israel"
        />

        <!-- Open Graph / Facebook -->
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://ci-events.org/" />
        <meta
            property="og:title"
            content="לוח אירועי קונטקט אימפרוביזציה בישראל"
        />
        <meta
            property="og:description"
            content="לוח אירועי קונטקט אימפרוביזציה בישראל - ג'אמים, סדנאות, פסטיבלים ומפגשי ריקוד"
        />
        <meta
            property="og:image"
            content="https://ci-events.org/og-image.jpg"
        />

        <!-- Twitter -->
        <meta property="twitter:card" content="summary_large_image" />
        <meta property="twitter:url" content="https://ci-events.org/" />
        <meta
            property="twitter:title"
            content="לוח אירועי קונטקט אימפרוביזציה בישראל"
        />
        <meta
            property="twitter:description"
            content="לוח אירועי קונטקט אימפרוביזציה בישראל - ג'אמים, סדנאות, פסטיבלים ומפגשי ריקוד"
        />
        <meta
            property="twitter:image"
            content="https://ci-events.org/og-image.jpg"
        />

        <!-- PWA -->
        <link rel="manifest" href="/site.webmanifest" />
        <meta name="theme-color" content="#171717" />
        <link rel="apple-touch-icon" href="/ci-circle-192.png" />

        <!-- Viewport -->
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
        />

        <!-- Google tag (gtag.js) -->
        <!-- <script
            async
            src=`https://www.googletagmanager.com/gtag/js?id=${import.meta.env.VITE_GOOGLE_ANALYTICS_ID}`
        ></script> -->
        <script>
            // Initialize dataLayer first
            window.dataLayer = window.dataLayer || []
            function gtag() {
                dataLayer.push(arguments)
            }

            // Check if internal user before loading GA

            const isProd =
                window.location.hostname === "ci-events.org" ||
                window.location.hostname === "www.ci-events.org"
            console.log("Environment:", isProd ? "production" : "development")

            const disableTracking =
                localStorage.getItem("isInternal") === "true" || !isProd

            if (!disableTracking) {
                // Load GA script dynamically only for non-internal users
                const gaScript = document.createElement("script")
                gaScript.async = true
                gaScript.src =
                    "https://www.googletagmanager.com/gtag/js?id=G-MX441RRM7Q"
                document.head.appendChild(gaScript)

                // Initialize GA
                gtag("js", new Date())
                gtag("config", "G-MX441RRM7Q")
            } else {
                // Mock gtag for internal users
                window.gtag = function () {
                    console.log(
                        "GA Event (disabled for internal user):",
                        arguments
                    )
                }
            }
        </script>

        <!-- Robots -->
        <script type="text/javascript">
            const prodDomain = "ci-events.org"
            const currentDomain = window.location.hostname
            const indexedRoutes = ["/", "/about"]
            const currentPath = window.location.pathname

            // Only modify robots tag if NOT on production domain
            if (currentDomain !== prodDomain) {
                document.write(
                    '<meta name="robots" content="noindex, nofollow" />'
                )
            }
            // On production domain, we keep the default "index, follow"
        </script>

        <!-- Canonical URL -->
        <script type="text/javascript">
            const canonicalTag = document.querySelector('link[rel="canonical"]')
            if (canonicalTag && currentDomain !== prodDomain) {
                // Always point canonical to production domain
                canonicalTag.href = `https://${prodDomain}${window.location.pathname}`
            }
        </script>

        <!-- For staging domain -->
        <script type="text/javascript">
            if (window.location.hostname !== "ci-events.org") {
                document.write(
                    '<meta name="robots" content="noindex, nofollow" />'
                )
            }
        </script>
    </head>

    <body>
        <style>
            #initial-loader {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: #e8ebf2;
                display: flex;
                justify-content: center;
                align-items: center;
                flex-direction: column;
                gap: 1rem;
                z-index: 9999;
            }

            #initial-loader img {
                width: 80px;
                height: 80px;
                animation: pulse 1.5s infinite;
            }

            @keyframes pulse {
                0% {
                    transform: scale(0.95);
                    opacity: 0.8;
                }
                50% {
                    transform: scale(1);
                    opacity: 1;
                }
                100% {
                    transform: scale(0.95);
                    opacity: 0.8;
                }
            }
        </style>
        <div id="root"></div>
        <div id="initial-loader">
            <img src="/ci-logo.svg" alt="Loading..." />
            <h2 style="margin: 0; color: #444444; font-size: 1.2rem">
                קונטקט אימפרוביזציה ישראל
            </h2>
        </div>
        <script type="module" src="/src/main.tsx"></script>

        <script type="application/ld+json">
            {
                "@context": "https://schema.org",
                "@type": "WebSite",
                "name": "לוח אירועי קונטקט אימפרוביזציה",
                "url": "https://ci-events.org",
                "description": "לוח אירועי קונטקט אימפרוביזציה בישראל - ג'אמים, סדנאות, פסטיבלים ומפגשי ריקוד",
                "inLanguage": ["he", "en"]
            }
        </script>
    </body>
</html>
